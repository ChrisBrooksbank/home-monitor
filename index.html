<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0">
    <title>üè† 28 Barn Green - Home Monitor</title>

    <!-- PWA Meta Tags -->
    <meta name="description" content="Home monitoring dashboard for 28 Barn Green">
    <meta name="theme-color" content="#87CEEB">
    <link rel="manifest" href="/manifest.json">

    <!-- Apple Touch Icons -->
    <link rel="apple-touch-icon" href="/icons/icon-152x152.png">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="Home Monitor">
    <link rel="stylesheet" href="css/main.css">
</head>
<body>
    <!-- Clouds -->
    <div class="cloud cloud1"></div>
    <div class="cloud cloud2"></div>

    <!-- Birds -->
    <div class="bird bird1">üê¶</div>
    <div class="bird bird2">üïäÔ∏è</div>

    <div class="container">
        <div class="header-row">
            <h1>üè° 28 Barn Green üå°Ô∏è</h1>
            <div class="header-controls">
                <div class="connection-status" id="connectionStatus" title="Connection status">
                    <span class="status-indicator" id="status-hue" data-service="hue">
                        <span class="status-dot"></span>
                        <span class="status-name">Hue</span>
                    </span>
                    <span class="status-divider">|</span>
                    <span class="status-indicator" id="status-sonos" data-service="sonos">
                        <span class="status-dot"></span>
                        <span class="status-name">Sonos</span>
                    </span>
                    <span class="status-indicator" id="status-tapo" data-service="tapo">
                        <span class="status-dot"></span>
                        <span class="status-name">Tapo</span>
                    </span>
                    <span class="status-indicator" id="status-shield" data-service="shield">
                        <span class="status-dot"></span>
                        <span class="status-name">SHIELD</span>
                    </span>
                </div>
            </div>
        </div>
        <div class="last-update" id="lastUpdate">Loading magical temperatures...</div>

        <div class="house-container">
            <svg viewBox="40 10 920 640" xmlns="http://www.w3.org/2000/svg">
                <defs>
                    <!-- ============================================
                         PIXEL ART UK HOUSE - GRADIENTS & PATTERNS
                         ============================================ -->

                    <!-- Sky Gradient - Soft British sky -->
                    <linearGradient id="skyGradient" x1="0%" y1="0%" x2="0%" y2="100%">
                        <stop offset="0%" style="stop-color:#87CEEB;stop-opacity:0.3" />
                        <stop offset="100%" style="stop-color:#E0F6FF;stop-opacity:0.1" />
                    </linearGradient>

                    <!-- Brick Colors - Authentic UK Red Brick -->
                    <linearGradient id="brickFace" x1="0%" y1="0%" x2="0%" y2="100%">
                        <stop offset="0%" style="stop-color:#C45C3E" />
                        <stop offset="50%" style="stop-color:#B84C2F" />
                        <stop offset="100%" style="stop-color:#A63D22" />
                    </linearGradient>

                    <!-- Roof Tiles - Terracotta -->
                    <linearGradient id="roofTile" x1="0%" y1="0%" x2="0%" y2="100%">
                        <stop offset="0%" style="stop-color:#8B4513" />
                        <stop offset="40%" style="stop-color:#A0522D" />
                        <stop offset="100%" style="stop-color:#6B3410" />
                    </linearGradient>

                    <!-- Door - Heritage Teal -->
                    <linearGradient id="doorGradient" x1="0%" y1="0%" x2="100%" y2="100%">
                        <stop offset="0%" style="stop-color:#2D5A5A" />
                        <stop offset="50%" style="stop-color:#1E4040" />
                        <stop offset="100%" style="stop-color:#153030" />
                    </linearGradient>

                    <!-- Window Glass - Slight reflection -->
                    <linearGradient id="windowGlass" x1="0%" y1="0%" x2="100%" y2="100%">
                        <stop offset="0%" style="stop-color:#A8D8EA" />
                        <stop offset="30%" style="stop-color:#87CEEB" />
                        <stop offset="100%" style="stop-color:#5DADE2" />
                    </linearGradient>

                    <!-- Window Glass Night -->
                    <linearGradient id="windowGlassNight" x1="0%" y1="0%" x2="100%" y2="100%">
                        <stop offset="0%" style="stop-color:#FFE4B5" />
                        <stop offset="50%" style="stop-color:#FFDAB9" />
                        <stop offset="100%" style="stop-color:#FFD39B" />
                    </linearGradient>

                    <!-- Grass -->
                    <linearGradient id="grassGradient" x1="0%" y1="0%" x2="0%" y2="100%">
                        <stop offset="0%" style="stop-color:#5D8A4A" />
                        <stop offset="100%" style="stop-color:#3D6A2A" />
                    </linearGradient>

                    <!-- Garden Path -->
                    <linearGradient id="pathGradient" x1="0%" y1="0%" x2="0%" y2="100%">
                        <stop offset="0%" style="stop-color:#D4C4A8" />
                        <stop offset="100%" style="stop-color:#B8A88C" />
                    </linearGradient>

                    <!-- Stone/Lintel -->
                    <linearGradient id="stoneGradient" x1="0%" y1="0%" x2="0%" y2="100%">
                        <stop offset="0%" style="stop-color:#E8E0D0" />
                        <stop offset="100%" style="stop-color:#C8C0B0" />
                    </linearGradient>

                    <!-- Nest Thermostat metallic gradient -->
                    <radialGradient id="nestMetalGradient" cx="30%" cy="30%">
                        <stop offset="0%" style="stop-color:#F5F5F5" />
                        <stop offset="50%" style="stop-color:#D3D3D3" />
                        <stop offset="100%" style="stop-color:#A8A8A8" />
                    </radialGradient>

                    <!-- Room temperature gradients -->
                    <linearGradient id="coldGradient" x1="0%" y1="0%" x2="100%" y2="100%">
                        <stop offset="0%" style="stop-color:#A8DADC;stop-opacity:0.85" />
                        <stop offset="100%" style="stop-color:#457B9D;stop-opacity:0.85" />
                    </linearGradient>

                    <linearGradient id="coolGradient" x1="0%" y1="0%" x2="100%" y2="100%">
                        <stop offset="0%" style="stop-color:#B8E0D2;stop-opacity:0.85" />
                        <stop offset="100%" style="stop-color:#7FB5A0;stop-opacity:0.85" />
                    </linearGradient>

                    <linearGradient id="warmGradient" x1="0%" y1="0%" x2="100%" y2="100%">
                        <stop offset="0%" style="stop-color:#FFE0B2;stop-opacity:0.85" />
                        <stop offset="100%" style="stop-color:#FFCC80;stop-opacity:0.85" />
                    </linearGradient>

                    <linearGradient id="hotGradient" x1="0%" y1="0%" x2="100%" y2="100%">
                        <stop offset="0%" style="stop-color:#FFAB91;stop-opacity:0.85" />
                        <stop offset="100%" style="stop-color:#FF8A65;stop-opacity:0.85" />
                    </linearGradient>

                    <!-- ============================================
                         PIXEL ART PATTERNS
                         ============================================ -->

                    <!-- Detailed UK Brick Pattern -->
                    <pattern id="pixelBrickPattern" x="0" y="0" width="24" height="12" patternUnits="userSpaceOnUse">
                        <!-- Row 1 -->
                        <rect x="0" y="0" width="11" height="5" fill="#C45C3E"/>
                        <rect x="1" y="1" width="9" height="3" fill="#D46A4C"/>
                        <rect x="12" y="0" width="11" height="5" fill="#B84C2F"/>
                        <rect x="13" y="1" width="9" height="3" fill="#C85A3D"/>
                        <!-- Mortar -->
                        <rect x="11" y="0" width="1" height="5" fill="#E8E0D0"/>
                        <rect x="0" y="5" width="24" height="1" fill="#E8E0D0"/>
                        <!-- Row 2 (offset) -->
                        <rect x="0" y="6" width="5" height="5" fill="#A63D22"/>
                        <rect x="1" y="7" width="3" height="3" fill="#B64D32"/>
                        <rect x="6" y="6" width="11" height="5" fill="#C45C3E"/>
                        <rect x="7" y="7" width="9" height="3" fill="#D46A4C"/>
                        <rect x="18" y="6" width="6" height="5" fill="#B84C2F"/>
                        <rect x="19" y="7" width="4" height="3" fill="#C85A3D"/>
                        <!-- Mortar -->
                        <rect x="5" y="6" width="1" height="5" fill="#E8E0D0"/>
                        <rect x="17" y="6" width="1" height="5" fill="#E8E0D0"/>
                        <rect x="0" y="11" width="24" height="1" fill="#E8E0D0"/>
                    </pattern>

                    <!-- Roof Tile Pattern -->
                    <pattern id="roofTilePattern" x="0" y="0" width="16" height="10" patternUnits="userSpaceOnUse">
                        <!-- Tile row 1 -->
                        <path d="M0,0 L8,0 L8,8 Q4,10 0,8 Z" fill="#8B4513"/>
                        <path d="M8,0 L16,0 L16,8 Q12,10 8,8 Z" fill="#A0522D"/>
                        <!-- Highlights -->
                        <rect x="1" y="1" width="6" height="2" fill="#9D5B2A" opacity="0.6"/>
                        <rect x="9" y="1" width="6" height="2" fill="#B06530" opacity="0.6"/>
                    </pattern>

                    <!-- Garden Fence Pattern -->
                    <pattern id="fencePattern" x="0" y="0" width="12" height="40" patternUnits="userSpaceOnUse">
                        <rect x="0" y="0" width="2" height="40" fill="#8B7355"/>
                        <rect x="1" y="0" width="1" height="40" fill="#9D8567"/>
                        <rect x="10" y="0" width="2" height="40" fill="#8B7355"/>
                        <rect x="0" y="8" width="12" height="3" fill="#7A6245"/>
                        <rect x="0" y="28" width="12" height="3" fill="#7A6245"/>
                    </pattern>

                    <!-- Filters -->
                    <filter id="shadow">
                        <feDropShadow dx="0" dy="4" stdDeviation="4" flood-opacity="0.3"/>
                    </filter>

                    <filter id="glow">
                        <feGaussianBlur stdDeviation="3" result="coloredBlur"/>
                        <feMerge>
                            <feMergeNode in="coloredBlur"/>
                            <feMergeNode in="SourceGraphic"/>
                        </feMerge>
                    </filter>

                    <filter id="pixelShadow">
                        <feDropShadow dx="2" dy="2" stdDeviation="0" flood-color="#000" flood-opacity="0.2"/>
                    </filter>
                </defs>

                <!-- Sky background -->
                <rect width="1000" height="650" fill="url(#skyGradient)"/>

                <!-- Weather Info Panel (Top Right) -->
                <g id="weather-info-panel" transform="translate(800, 30)">
                    <!-- Semi-transparent background -->
                    <rect x="0" y="0" width="180" height="110" rx="15" fill="rgba(255, 255, 255, 0.85)" stroke="rgba(100, 100, 100, 0.3)" stroke-width="2"/>

                    <!-- Weather Icon -->
                    <image id="weather-icon-svg" x="10" y="10" width="50" height="50" href=""/>

                    <!-- Temperature -->
                    <text id="weather-temp-svg" x="70" y="35" font-size="28" font-weight="bold" fill="#333" font-family="Arial">--¬∞</text>

                    <!-- Condition -->
                    <text id="weather-condition-svg" x="70" y="52" font-size="11" fill="#666" font-family="Arial">Loading...</text>

                    <!-- Feels Like -->
                    <text id="weather-feels-svg" x="10" y="75" font-size="10" fill="#555" font-family="Arial">Feels: --¬∞</text>

                    <!-- Humidity & UV -->
                    <text id="weather-humidity-svg" x="10" y="90" font-size="9" fill="#555" font-family="Arial">üíß --%</text>
                    <text id="weather-uv-svg" x="10" y="103" font-size="9" fill="#555" font-family="Arial">‚òÄÔ∏è UV -</text>

                    <!-- Wind -->
                    <text id="weather-wind-svg" x="100" y="75" font-size="9" fill="#555" font-family="Arial">üå¨Ô∏è -- km/h</text>
                    <text id="weather-wind-dir-svg" x="100" y="88" font-size="9" fill="#555" font-family="Arial">--</text>
                </g>

                <!-- Sun -->
                <g id="sun" style="animation: spin 30s linear infinite; transform-origin: 880px 100px;">
                    <circle cx="880" cy="100" r="50" fill="#FFD700" opacity="0.8" filter="url(#glow)"/>
                    <circle cx="880" cy="100" r="40" fill="#FFA500"/>
                </g>

                <!-- Moon (hidden during day) -->
                <g id="moon" style="display: none;">
                    <circle cx="850" cy="120" r="45" fill="#F0F0F0" filter="url(#glow)"/>
                    <circle cx="860" cy="115" r="40" fill="#E8E8E8"/>
                    <!-- Craters -->
                    <circle cx="845" cy="110" r="8" fill="#D0D0D0" opacity="0.6"/>
                    <circle cx="870" cy="125" r="6" fill="#D0D0D0" opacity="0.5"/>
                    <circle cx="855" cy="135" r="5" fill="#D0D0D0" opacity="0.7"/>
                </g>

                <!-- Stars (hidden during day) -->
                <g id="stars" style="display: none;">
                    <circle cx="100" cy="50" r="2" fill="white" opacity="0.9">
                        <animate attributeName="opacity" values="0.9;0.3;0.9" dur="3s" repeatCount="indefinite"/>
                    </circle>
                    <circle cx="200" cy="80" r="1.5" fill="white" opacity="0.8">
                        <animate attributeName="opacity" values="0.8;0.4;0.8" dur="2.5s" repeatCount="indefinite" begin="0.5s"/>
                    </circle>
                    <circle cx="350" cy="40" r="2" fill="white" opacity="0.9">
                        <animate attributeName="opacity" values="0.9;0.2;0.9" dur="4s" repeatCount="indefinite" begin="1s"/>
                    </circle>
                    <circle cx="500" cy="70" r="1.5" fill="white" opacity="0.7">
                        <animate attributeName="opacity" values="0.7;0.3;0.7" dur="3.5s" repeatCount="indefinite" begin="1.5s"/>
                    </circle>
                    <circle cx="650" cy="45" r="2" fill="white" opacity="0.9">
                        <animate attributeName="opacity" values="0.9;0.4;0.9" dur="3s" repeatCount="indefinite" begin="0.8s"/>
                    </circle>
                    <circle cx="750" cy="90" r="1.5" fill="white" opacity="0.8">
                        <animate attributeName="opacity" values="0.8;0.3;0.8" dur="2.8s" repeatCount="indefinite" begin="2s"/>
                    </circle>
                    <circle cx="150" cy="120" r="1" fill="white" opacity="0.7">
                        <animate attributeName="opacity" values="0.7;0.2;0.7" dur="3.2s" repeatCount="indefinite" begin="0.3s"/>
                    </circle>
                    <circle cx="300" cy="110" r="1.5" fill="white" opacity="0.8">
                        <animate attributeName="opacity" values="0.8;0.4;0.8" dur="3.8s" repeatCount="indefinite" begin="1.2s"/>
                    </circle>
                    <circle cx="450" cy="130" r="1" fill="white" opacity="0.7">
                        <animate attributeName="opacity" values="0.7;0.3;0.7" dur="2.7s" repeatCount="indefinite" begin="1.8s"/>
                    </circle>
                    <circle cx="600" cy="100" r="1.5" fill="white" opacity="0.9">
                        <animate attributeName="opacity" values="0.9;0.3;0.9" dur="3.3s" repeatCount="indefinite" begin="0.6s"/>
                    </circle>
                    <circle cx="800" cy="55" r="2" fill="white" opacity="0.8">
                        <animate attributeName="opacity" values="0.8;0.2;0.8" dur="4.2s" repeatCount="indefinite" begin="2.5s"/>
                    </circle>
                    <circle cx="920" cy="75" r="1.5" fill="white" opacity="0.9">
                        <animate attributeName="opacity" values="0.9;0.4;0.9" dur="3.6s" repeatCount="indefinite" begin="1.3s"/>
                    </circle>
                </g>

                <!-- Weather Effects -->
                <!-- Rain (hidden by default) -->
                <g id="rain" style="display: none;">
                    <line x1="50" y1="0" x2="48" y2="80" stroke="#A0C8E0" stroke-width="2" opacity="0.6">
                        <animate attributeName="y1" values="0;600" dur="1s" repeatCount="indefinite"/>
                        <animate attributeName="y2" values="80;680" dur="1s" repeatCount="indefinite"/>
                    </line>
                    <line x1="150" y1="0" x2="148" y2="80" stroke="#A0C8E0" stroke-width="2" opacity="0.6">
                        <animate attributeName="y1" values="-50;550" dur="1s" repeatCount="indefinite"/>
                        <animate attributeName="y2" values="30;630" dur="1s" repeatCount="indefinite"/>
                    </line>
                    <line x1="250" y1="0" x2="248" y2="80" stroke="#A0C8E0" stroke-width="2" opacity="0.6">
                        <animate attributeName="y1" values="0;600" dur="0.9s" repeatCount="indefinite"/>
                        <animate attributeName="y2" values="80;680" dur="0.9s" repeatCount="indefinite"/>
                    </line>
                    <line x1="350" y1="0" x2="348" y2="80" stroke="#A0C8E0" stroke-width="2" opacity="0.6">
                        <animate attributeName="y1" values="-30;570" dur="1.1s" repeatCount="indefinite"/>
                        <animate attributeName="y2" values="50;650" dur="1.1s" repeatCount="indefinite"/>
                    </line>
                    <line x1="450" y1="0" x2="448" y2="80" stroke="#A0C8E0" stroke-width="2" opacity="0.6">
                        <animate attributeName="y1" values="0;600" dur="1s" repeatCount="indefinite"/>
                        <animate attributeName="y2" values="80;680" dur="1s" repeatCount="indefinite"/>
                    </line>
                    <line x1="550" y1="0" x2="548" y2="80" stroke="#A0C8E0" stroke-width="2" opacity="0.6">
                        <animate attributeName="y1" values="-40;560" dur="0.95s" repeatCount="indefinite"/>
                        <animate attributeName="y2" values="40;640" dur="0.95s" repeatCount="indefinite"/>
                    </line>
                    <line x1="650" y1="0" x2="648" y2="80" stroke="#A0C8E0" stroke-width="2" opacity="0.6">
                        <animate attributeName="y1" values="0;600" dur="1.05s" repeatCount="indefinite"/>
                        <animate attributeName="y2" values="80;680" dur="1.05s" repeatCount="indefinite"/>
                    </line>
                    <line x1="750" y1="0" x2="748" y2="80" stroke="#A0C8E0" stroke-width="2" opacity="0.6">
                        <animate attributeName="y1" values="-20;580" dur="1s" repeatCount="indefinite"/>
                        <animate attributeName="y2" values="60;660" dur="1s" repeatCount="indefinite"/>
                    </line>
                    <line x1="850" y1="0" x2="848" y2="80" stroke="#A0C8E0" stroke-width="2" opacity="0.6">
                        <animate attributeName="y1" values="0;600" dur="0.92s" repeatCount="indefinite"/>
                        <animate attributeName="y2" values="80;680" dur="0.92s" repeatCount="indefinite"/>
                    </line>
                    <line x1="950" y1="0" x2="948" y2="80" stroke="#A0C8E0" stroke-width="2" opacity="0.6">
                        <animate attributeName="y1" values="-35;565" dur="1.08s" repeatCount="indefinite"/>
                        <animate attributeName="y2" values="45;645" dur="1.08s" repeatCount="indefinite"/>
                    </line>
                </g>

                <!-- Snow (hidden by default) -->
                <g id="snow" style="display: none;">
                    <circle cx="80" cy="0" r="3" fill="white" opacity="0.9">
                        <animate attributeName="cy" values="0;650" dur="8s" repeatCount="indefinite"/>
                        <animate attributeName="cx" values="80;90;75;85;80" dur="8s" repeatCount="indefinite"/>
                    </circle>
                    <circle cx="200" cy="0" r="4" fill="white" opacity="0.85">
                        <animate attributeName="cy" values="-50;600" dur="10s" repeatCount="indefinite"/>
                        <animate attributeName="cx" values="200;210;195;205;200" dur="10s" repeatCount="indefinite"/>
                    </circle>
                    <circle cx="320" cy="0" r="3.5" fill="white" opacity="0.9">
                        <animate attributeName="cy" values="0;650" dur="9s" repeatCount="indefinite"/>
                        <animate attributeName="cx" values="320;330;315;325;320" dur="9s" repeatCount="indefinite"/>
                    </circle>
                    <circle cx="450" cy="0" r="3" fill="white" opacity="0.88">
                        <animate attributeName="cy" values="-80;570" dur="11s" repeatCount="indefinite"/>
                        <animate attributeName="cx" values="450;460;445;455;450" dur="11s" repeatCount="indefinite"/>
                    </circle>
                    <circle cx="570" cy="0" r="4" fill="white" opacity="0.9">
                        <animate attributeName="cy" values="0;650" dur="8.5s" repeatCount="indefinite"/>
                        <animate attributeName="cx" values="570;580;565;575;570" dur="8.5s" repeatCount="indefinite"/>
                    </circle>
                    <circle cx="690" cy="0" r="3.5" fill="white" opacity="0.87">
                        <animate attributeName="cy" values="-100;550" dur="10.5s" repeatCount="indefinite"/>
                        <animate attributeName="cx" values="690;700;685;695;690" dur="10.5s" repeatCount="indefinite"/>
                    </circle>
                    <circle cx="810" cy="0" r="3" fill="white" opacity="0.9">
                        <animate attributeName="cy" values="0;650" dur="9.5s" repeatCount="indefinite"/>
                        <animate attributeName="cx" values="810;820;805;815;810" dur="9.5s" repeatCount="indefinite"/>
                    </circle>
                    <circle cx="920" cy="0" r="4" fill="white" opacity="0.86">
                        <animate attributeName="cy" values="-60;590" dur="11.5s" repeatCount="indefinite"/>
                        <animate attributeName="cx" values="920;930;915;925;920" dur="11.5s" repeatCount="indefinite"/>
                    </circle>
                </g>

                <!-- Fog/Mist (hidden by default) -->
                <g id="fog" style="display: none;">
                    <ellipse cx="200" cy="500" rx="300" ry="80" fill="white" opacity="0.3">
                        <animate attributeName="opacity" values="0.3;0.5;0.3" dur="6s" repeatCount="indefinite"/>
                    </ellipse>
                    <ellipse cx="600" cy="480" rx="350" ry="90" fill="white" opacity="0.25">
                        <animate attributeName="opacity" values="0.25;0.45;0.25" dur="7s" repeatCount="indefinite" begin="1s"/>
                    </ellipse>
                    <ellipse cx="400" cy="520" rx="280" ry="70" fill="white" opacity="0.35">
                        <animate attributeName="opacity" values="0.35;0.55;0.35" dur="5.5s" repeatCount="indefinite" begin="2s"/>
                    </ellipse>
                    <ellipse cx="800" cy="510" rx="320" ry="85" fill="white" opacity="0.28">
                        <animate attributeName="opacity" values="0.28;0.48;0.28" dur="6.5s" repeatCount="indefinite" begin="0.5s"/>
                    </ellipse>
                </g>

                <!-- ============================================
                     GARDEN & GROUND
                     ============================================ -->

                <!-- Main grass area -->
                <ellipse cx="500" cy="670" rx="550" ry="60" fill="url(#grassGradient)"/>
                <ellipse cx="300" cy="655" rx="180" ry="30" fill="#4A7A3A" opacity="0.5"/>
                <ellipse cx="700" cy="660" rx="200" ry="35" fill="#4A7A3A" opacity="0.5"/>

                <!-- Garden path to front door -->
                <path d="M200,650 L200,600 Q200,590 210,590 L190,590 Q180,590 180,600 L180,650" fill="url(#pathGradient)" stroke="#A09080" stroke-width="1"/>
                <rect x="175" y="595" width="50" height="55" fill="url(#pathGradient)" stroke="#A09080" stroke-width="1"/>
                <!-- Path stones -->
                <rect x="178" y="600" width="20" height="12" fill="#C8B898" rx="1"/>
                <rect x="202" y="600" width="18" height="12" fill="#D4C4A8" rx="1"/>
                <rect x="180" y="615" width="18" height="12" fill="#D4C4A8" rx="1"/>
                <rect x="202" y="615" width="16" height="12" fill="#C8B898" rx="1"/>
                <rect x="178" y="630" width="22" height="12" fill="#D4C4A8" rx="1"/>
                <rect x="204" y="630" width="16" height="12" fill="#C8B898" rx="1"/>

                <!-- ============================================
                     PIXEL ART UK SEMI-DETACHED HOUSE
                     ============================================ -->
                <g id="house-main" filter="url(#shadow)">

                    <!-- ========== NEIGHBOR HOUSE (LEFT PARTIAL) ========== -->
                    <rect x="20" y="240" width="85" height="360" fill="#B84C2F"/>
                    <rect x="20" y="240" width="85" height="360" fill="url(#pixelBrickPattern)"/>
                    <!-- Neighbor roof edge -->
                    <polygon points="20,240 60,180 105,240" fill="url(#roofTile)"/>
                    <rect x="20" y="235" width="85" height="8" fill="#6B3410"/>

                    <!-- ========== MAIN HOUSE STRUCTURE ========== -->
                    <!-- Base brick walls -->
                    <rect x="105" y="230" width="795" height="370" fill="#C45C3E"/>
                    <rect x="105" y="230" width="795" height="370" fill="url(#pixelBrickPattern)"/>

                    <!-- Stone foundation strip -->
                    <rect x="100" y="590" width="805" height="12" fill="url(#stoneGradient)" stroke="#A09080" stroke-width="1"/>

                    <!-- ========== PITCHED ROOF ========== -->
                    <!-- Main roof shape -->
                    <polygon points="85,230 500,100 915,230" fill="url(#roofTile)"/>
                    <polygon points="85,230 500,100 915,230" fill="url(#roofTilePattern)" opacity="0.8"/>

                    <!-- Roof edge/fascia -->
                    <polygon points="80,235 500,102 920,235 915,230 500,100 85,230" fill="#5A3010"/>

                    <!-- Roof ridge tiles -->
                    <line x1="500" y1="100" x2="85" y2="230" stroke="#6B3410" stroke-width="4"/>
                    <line x1="500" y1="100" x2="915" y2="230" stroke="#6B3410" stroke-width="4"/>

                    <!-- Decorative roof lines -->
                    <line x1="290" y1="165" x2="85" y2="230" stroke="#7A4420" stroke-width="1" opacity="0.5"/>
                    <line x1="710" y1="165" x2="915" y2="230" stroke="#7A4420" stroke-width="1" opacity="0.5"/>

                    <!-- ========== CHIMNEY ========== -->
                    <g id="chimney">
                        <!-- Chimney stack -->
                        <rect x="680" y="95" width="55" height="135" fill="#C45C3E"/>
                        <rect x="680" y="95" width="55" height="135" fill="url(#pixelBrickPattern)"/>
                        <!-- Chimney cap -->
                        <rect x="675" y="88" width="65" height="10" fill="#5A3010"/>
                        <rect x="678" y="82" width="59" height="8" fill="#6B3410"/>

                        <!-- Chimney pots (terracotta) -->
                        <g id="chimney-pots">
                            <!-- Pot 1 -->
                            <rect x="688" y="62" width="14" height="22" fill="#B84C2F" stroke="#8B3A1E" stroke-width="1"/>
                            <rect x="686" y="60" width="18" height="4" fill="#A63D22"/>
                            <rect x="687" y="80" width="16" height="4" fill="#8B3A1E"/>
                            <!-- Pot 2 -->
                            <rect x="712" y="62" width="14" height="22" fill="#C45C3E" stroke="#8B3A1E" stroke-width="1"/>
                            <rect x="710" y="60" width="18" height="4" fill="#B84C2F"/>
                            <rect x="711" y="80" width="16" height="4" fill="#8B3A1E"/>
                        </g>

                        <!-- Animated smoke puffs -->
                        <g id="smoke">
                            <circle cx="695" cy="50" r="6" fill="#E8E8E8" opacity="0.4">
                                <animate attributeName="cy" values="50;20;-10" dur="4s" repeatCount="indefinite"/>
                                <animate attributeName="r" values="6;10;14" dur="4s" repeatCount="indefinite"/>
                                <animate attributeName="opacity" values="0.4;0.2;0" dur="4s" repeatCount="indefinite"/>
                            </circle>
                            <circle cx="720" cy="48" r="5" fill="#E0E0E0" opacity="0.35">
                                <animate attributeName="cy" values="48;18;-12" dur="4.5s" repeatCount="indefinite" begin="1s"/>
                                <animate attributeName="r" values="5;9;13" dur="4.5s" repeatCount="indefinite" begin="1s"/>
                                <animate attributeName="opacity" values="0.35;0.15;0" dur="4.5s" repeatCount="indefinite" begin="1s"/>
                            </circle>
                            <circle cx="705" cy="45" r="4" fill="#D8D8D8" opacity="0.3">
                                <animate attributeName="cy" values="45;15;-15" dur="5s" repeatCount="indefinite" begin="2s"/>
                                <animate attributeName="r" values="4;8;12" dur="5s" repeatCount="indefinite" begin="2s"/>
                                <animate attributeName="opacity" values="0.3;0.1;0" dur="5s" repeatCount="indefinite" begin="2s"/>
                            </circle>
                        </g>
                    </g>

                    <!-- ========== FIRST FLOOR WINDOWS (SASH STYLE) ========== -->
                    <g id="first-floor-windows">
                        <!-- Window 1 - Main Bedroom -->
                        <g class="pixel-window" transform="translate(140, 260)">
                            <rect x="0" y="-8" width="52" height="8" fill="url(#stoneGradient)"/><!-- Lintel -->
                            <rect x="0" y="0" width="52" height="65" fill="url(#windowGlass)"/>
                            <rect x="0" y="0" width="52" height="65" fill="none" stroke="#F5F5F0" stroke-width="4"/>
                            <line x1="26" y1="0" x2="26" y2="65" stroke="#F5F5F0" stroke-width="3"/>
                            <line x1="0" y1="32" x2="52" y2="32" stroke="#F5F5F0" stroke-width="3"/>
                            <rect x="-2" y="65" width="56" height="6" fill="url(#stoneGradient)"/><!-- Sill -->
                        </g>

                        <!-- Window 2 - Landing -->
                        <g class="pixel-window" transform="translate(305, 260)">
                            <rect x="0" y="-8" width="52" height="8" fill="url(#stoneGradient)"/>
                            <rect x="0" y="0" width="52" height="65" fill="url(#windowGlass)"/>
                            <rect x="0" y="0" width="52" height="65" fill="none" stroke="#F5F5F0" stroke-width="4"/>
                            <line x1="26" y1="0" x2="26" y2="65" stroke="#F5F5F0" stroke-width="3"/>
                            <line x1="0" y1="32" x2="52" y2="32" stroke="#F5F5F0" stroke-width="3"/>
                            <rect x="-2" y="65" width="56" height="6" fill="url(#stoneGradient)"/>
                        </g>

                        <!-- Window 3 - Home Office -->
                        <g class="pixel-window" transform="translate(465, 260)">
                            <rect x="0" y="-8" width="52" height="8" fill="url(#stoneGradient)"/>
                            <rect x="0" y="0" width="52" height="65" fill="url(#windowGlass)"/>
                            <rect x="0" y="0" width="52" height="65" fill="none" stroke="#F5F5F0" stroke-width="4"/>
                            <line x1="26" y1="0" x2="26" y2="65" stroke="#F5F5F0" stroke-width="3"/>
                            <line x1="0" y1="32" x2="52" y2="32" stroke="#F5F5F0" stroke-width="3"/>
                            <rect x="-2" y="65" width="56" height="6" fill="url(#stoneGradient)"/>
                        </g>

                        <!-- Window 4 - Bathroom (smaller) -->
                        <g class="pixel-window" transform="translate(630, 270)">
                            <rect x="0" y="-6" width="40" height="6" fill="url(#stoneGradient)"/>
                            <rect x="0" y="0" width="40" height="50" fill="url(#windowGlass)" opacity="0.7"/>
                            <rect x="0" y="0" width="40" height="50" fill="none" stroke="#F5F5F0" stroke-width="4"/>
                            <line x1="20" y1="0" x2="20" y2="50" stroke="#F5F5F0" stroke-width="2"/>
                            <line x1="0" y1="25" x2="40" y2="25" stroke="#F5F5F0" stroke-width="2"/>
                            <rect x="-2" y="50" width="44" height="5" fill="url(#stoneGradient)"/>
                        </g>

                        <!-- Window 5 - Guest Bedroom -->
                        <g class="pixel-window" transform="translate(780, 260)">
                            <rect x="0" y="-8" width="52" height="8" fill="url(#stoneGradient)"/>
                            <rect x="0" y="0" width="52" height="65" fill="url(#windowGlass)"/>
                            <rect x="0" y="0" width="52" height="65" fill="none" stroke="#F5F5F0" stroke-width="4"/>
                            <line x1="26" y1="0" x2="26" y2="65" stroke="#F5F5F0" stroke-width="3"/>
                            <line x1="0" y1="32" x2="52" y2="32" stroke="#F5F5F0" stroke-width="3"/>
                            <rect x="-2" y="65" width="56" height="6" fill="url(#stoneGradient)"/>
                        </g>
                    </g>

                    <!-- ========== GROUND FLOOR WINDOWS ========== -->
                    <g id="ground-floor-windows">
                        <!-- Bay Window - Lounge (Classic UK feature!) -->
                        <g id="bay-window" transform="translate(340, 420)">
                            <!-- Bay structure -->
                            <polygon points="0,0 0,110 -20,110 -20,10 0,0" fill="#C45C3E"/>
                            <polygon points="0,0 0,110 -20,110 -20,10 0,0" fill="url(#pixelBrickPattern)"/>
                            <polygon points="80,0 80,110 100,110 100,10 80,0" fill="#C45C3E"/>
                            <polygon points="80,0 80,110 100,110 100,10 80,0" fill="url(#pixelBrickPattern)"/>
                            <!-- Bay roof -->
                            <polygon points="-25,8 40,-8 105,8 100,10 40,-5 -20,10" fill="#5A3010"/>
                            <!-- Bay windows - 3 panes -->
                            <rect x="-18" y="15" width="28" height="90" fill="url(#windowGlass)"/>
                            <rect x="-18" y="15" width="28" height="90" fill="none" stroke="#F5F5F0" stroke-width="3"/>
                            <line x1="-4" y1="15" x2="-4" y2="105" stroke="#F5F5F0" stroke-width="2"/>
                            <line x1="-18" y1="60" x2="10" y2="60" stroke="#F5F5F0" stroke-width="2"/>

                            <rect x="12" y="10" width="56" height="95" fill="url(#windowGlass)"/>
                            <rect x="12" y="10" width="56" height="95" fill="none" stroke="#F5F5F0" stroke-width="3"/>
                            <line x1="40" y1="10" x2="40" y2="105" stroke="#F5F5F0" stroke-width="2"/>
                            <line x1="12" y1="57" x2="68" y2="57" stroke="#F5F5F0" stroke-width="2"/>

                            <rect x="70" y="15" width="28" height="90" fill="url(#windowGlass)"/>
                            <rect x="70" y="15" width="28" height="90" fill="none" stroke="#F5F5F0" stroke-width="3"/>
                            <line x1="84" y1="15" x2="84" y2="105" stroke="#F5F5F0" stroke-width="2"/>
                            <line x1="70" y1="60" x2="98" y2="60" stroke="#F5F5F0" stroke-width="2"/>
                            <!-- Bay sill -->
                            <rect x="-22" y="105" width="124" height="8" fill="url(#stoneGradient)"/>
                        </g>

                        <!-- Kitchen Window -->
                        <g class="pixel-window" transform="translate(545, 430)">
                            <rect x="0" y="-8" width="70" height="8" fill="url(#stoneGradient)"/>
                            <rect x="0" y="0" width="70" height="85" fill="url(#windowGlass)"/>
                            <rect x="0" y="0" width="70" height="85" fill="none" stroke="#F5F5F0" stroke-width="4"/>
                            <line x1="35" y1="0" x2="35" y2="85" stroke="#F5F5F0" stroke-width="3"/>
                            <line x1="0" y1="42" x2="70" y2="42" stroke="#F5F5F0" stroke-width="3"/>
                            <rect x="-3" y="85" width="76" height="7" fill="url(#stoneGradient)"/>
                        </g>

                        <!-- Extension Window -->
                        <g class="pixel-window" transform="translate(755, 430)">
                            <rect x="0" y="-8" width="70" height="8" fill="url(#stoneGradient)"/>
                            <rect x="0" y="0" width="70" height="85" fill="url(#windowGlass)"/>
                            <rect x="0" y="0" width="70" height="85" fill="none" stroke="#F5F5F0" stroke-width="4"/>
                            <line x1="35" y1="0" x2="35" y2="85" stroke="#F5F5F0" stroke-width="3"/>
                            <line x1="0" y1="42" x2="70" y2="42" stroke="#F5F5F0" stroke-width="3"/>
                            <rect x="-3" y="85" width="76" height="7" fill="url(#stoneGradient)"/>
                        </g>
                    </g>

                    <!-- ========== FRONT DOOR (HERITAGE STYLE) ========== -->
                    <g id="front-door" transform="translate(160, 450)">
                        <!-- Door frame/surround -->
                        <rect x="-8" y="-15" width="96" height="155" fill="url(#stoneGradient)" stroke="#A09080" stroke-width="2"/>
                        <!-- Door recess -->
                        <rect x="0" y="0" width="80" height="140" fill="#1A2A2A"/>
                        <!-- The door itself -->
                        <rect x="3" y="3" width="74" height="134" fill="url(#doorGradient)" stroke="#102020" stroke-width="2"/>
                        <!-- Door panels (Georgian style) -->
                        <rect x="10" y="10" width="28" height="35" fill="#244444" stroke="#102020" stroke-width="1" rx="2"/>
                        <rect x="42" y="10" width="28" height="35" fill="#244444" stroke="#102020" stroke-width="1" rx="2"/>
                        <rect x="10" y="52" width="28" height="40" fill="#244444" stroke="#102020" stroke-width="1" rx="2"/>
                        <rect x="42" y="52" width="28" height="40" fill="#244444" stroke="#102020" stroke-width="1" rx="2"/>
                        <rect x="10" y="98" width="60" height="32" fill="#244444" stroke="#102020" stroke-width="1" rx="2"/>
                        <!-- Door glass (top panels) -->
                        <rect x="12" y="12" width="24" height="31" fill="url(#windowGlass)" opacity="0.4"/>
                        <rect x="44" y="12" width="24" height="31" fill="url(#windowGlass)" opacity="0.4"/>
                        <!-- Letterbox -->
                        <rect x="25" y="75" width="30" height="8" fill="#C9A227" stroke="#8B7355" stroke-width="1" rx="1"/>
                        <rect x="28" y="77" width="24" height="4" fill="#1A1A1A"/>
                        <!-- Door handle -->
                        <circle cx="65" cy="95" r="5" fill="#C9A227" stroke="#8B7355" stroke-width="1"/>
                        <rect x="62" y="100" width="6" height="15" fill="#C9A227" stroke="#8B7355" stroke-width="1" rx="1"/>
                        <!-- Door knocker -->
                        <circle cx="40" cy="55" r="8" fill="none" stroke="#C9A227" stroke-width="3"/>
                        <rect x="37" y="55" width="6" height="12" fill="#C9A227" rx="1"/>
                    </g>

                    <!-- House Number -->
                    <g id="house-number" transform="translate(258, 480)">
                        <rect x="0" y="0" width="36" height="44" fill="#1A2A2A" stroke="#C9A227" stroke-width="2" rx="3"/>
                        <text x="18" y="32" text-anchor="middle" font-size="24" font-weight="700" font-family="Georgia, serif" fill="#C9A227">28</text>
                    </g>

                    <!-- ========== FLOWER BOXES ========== -->
                    <g id="flower-boxes">
                        <!-- Under first floor windows -->
                        <g transform="translate(138, 335)">
                            <rect x="0" y="0" width="56" height="12" fill="#5A3010" stroke="#3A2008" stroke-width="1"/>
                            <circle cx="10" cy="-4" r="5" fill="#FF69B4"/>
                            <circle cx="22" cy="-6" r="4" fill="#FFB6C1"/>
                            <circle cx="34" cy="-3" r="5" fill="#FF1493"/>
                            <circle cx="46" cy="-5" r="4" fill="#FF69B4"/>
                            <rect x="8" y="-2" width="2" height="4" fill="#228B22"/>
                            <rect x="20" y="-3" width="2" height="5" fill="#228B22"/>
                            <rect x="32" y="-1" width="2" height="3" fill="#228B22"/>
                            <rect x="44" y="-3" width="2" height="5" fill="#228B22"/>
                        </g>
                        <g transform="translate(778, 335)">
                            <rect x="0" y="0" width="56" height="12" fill="#5A3010" stroke="#3A2008" stroke-width="1"/>
                            <circle cx="10" cy="-5" r="4" fill="#9370DB"/>
                            <circle cx="22" cy="-4" r="5" fill="#8A2BE2"/>
                            <circle cx="34" cy="-6" r="4" fill="#9370DB"/>
                            <circle cx="46" cy="-4" r="5" fill="#BA55D3"/>
                            <rect x="8" y="-3" width="2" height="5" fill="#228B22"/>
                            <rect x="20" y="-2" width="2" height="4" fill="#228B22"/>
                            <rect x="32" y="-4" width="2" height="6" fill="#228B22"/>
                            <rect x="44" y="-2" width="2" height="4" fill="#228B22"/>
                        </g>
                    </g>

                    <!-- ========== CLIMBING ROSES (on wall) ========== -->
                    <g id="climbing-roses" transform="translate(110, 400)">
                        <!-- Vine -->
                        <path d="M0,200 Q10,150 5,100 Q0,50 15,0" fill="none" stroke="#2D5A2D" stroke-width="3"/>
                        <path d="M5,180 Q15,160 10,140" fill="none" stroke="#2D5A2D" stroke-width="2"/>
                        <path d="M8,120 Q-5,100 10,80" fill="none" stroke="#2D5A2D" stroke-width="2"/>
                        <!-- Rose blooms -->
                        <circle cx="5" cy="170" r="7" fill="#E84855"/>
                        <circle cx="3" cy="168" r="3" fill="#FF6B6B"/>
                        <circle cx="12" cy="130" r="6" fill="#FF4D6D"/>
                        <circle cx="10" cy="128" r="2" fill="#FF8FA3"/>
                        <circle cx="0" cy="90" r="7" fill="#E84855"/>
                        <circle cx="-2" cy="88" r="3" fill="#FF6B6B"/>
                        <circle cx="15" cy="50" r="5" fill="#FF4D6D"/>
                        <circle cx="13" cy="48" r="2" fill="#FF8FA3"/>
                        <!-- Leaves -->
                        <ellipse cx="10" cy="150" rx="5" ry="3" fill="#3D8B3D" transform="rotate(-30 10 150)"/>
                        <ellipse cx="0" cy="110" rx="5" ry="3" fill="#4A9A4A" transform="rotate(20 0 110)"/>
                        <ellipse cx="12" cy="70" rx="4" ry="2" fill="#3D8B3D" transform="rotate(-15 12 70)"/>
                    </g>

                    <!-- ========== GUTTERING & DOWNPIPES ========== -->
                    <g id="guttering">
                        <!-- Main gutter -->
                        <rect x="85" y="228" width="830" height="5" fill="#4A4A4A"/>
                        <rect x="85" y="230" width="830" height="3" fill="#5A5A5A"/>
                        <!-- Downpipes -->
                        <rect x="108" y="233" width="8" height="365" fill="#4A4A4A"/>
                        <rect x="110" y="233" width="4" height="365" fill="#5A5A5A"/>
                        <rect x="890" y="233" width="8" height="365" fill="#4A4A4A"/>
                        <rect x="892" y="233" width="4" height="365" fill="#5A5A5A"/>
                    </g>

                </g>

                <!-- ============================================
                     INTERIOR ROOMS (Overlays for temperature display)
                     ============================================ -->
                <g id="room-overlays">
                    <!-- FIRST FLOOR ROOMS (y: 230-355) -->
                    <!-- Main Bedroom -->
                    <rect x="105" y="230" width="155" height="125" fill="rgba(255,200,210,0.4)" stroke="rgba(180,140,100,0.6)" stroke-width="2"/>
                    <text x="182" y="255" text-anchor="middle" font-size="13" font-weight="600" font-family="'Fredoka', sans-serif" fill="#6B4423">Main Bedroom</text>

                    <!-- Landing -->
                    <rect x="260" y="230" width="155" height="125" fill="rgba(255,230,200,0.4)" stroke="rgba(180,140,100,0.6)" stroke-width="2"/>
                    <text x="337" y="255" text-anchor="middle" font-size="13" font-weight="600" font-family="'Fredoka', sans-serif" fill="#6B4423">Landing</text>
                    <!-- Pixel stairs -->
                    <g transform="translate(305, 280)">
                        <rect x="0" y="0" width="65" height="5" fill="rgba(139,90,43,0.5)"/>
                        <rect x="0" y="8" width="65" height="5" fill="rgba(139,90,43,0.5)"/>
                        <rect x="0" y="16" width="65" height="5" fill="rgba(139,90,43,0.5)"/>
                        <rect x="0" y="24" width="65" height="5" fill="rgba(139,90,43,0.5)"/>
                        <rect x="0" y="32" width="65" height="5" fill="rgba(139,90,43,0.5)"/>
                    </g>

                    <!-- Home Office -->
                    <rect x="415" y="230" width="155" height="125" fill="rgba(200,220,240,0.4)" stroke="rgba(180,140,100,0.6)" stroke-width="2"/>
                    <text x="492" y="255" text-anchor="middle" font-size="13" font-weight="600" font-family="'Fredoka', sans-serif" fill="#6B4423">Home Office</text>

                    <!-- Bathroom -->
                    <rect x="570" y="230" width="155" height="125" fill="rgba(200,240,220,0.4)" stroke="rgba(180,140,100,0.6)" stroke-width="2"/>
                    <text x="647" y="255" text-anchor="middle" font-size="13" font-weight="600" font-family="'Fredoka', sans-serif" fill="#6B4423">Bathroom</text>

                    <!-- Guest Bedroom -->
                    <rect x="725" y="230" width="175" height="125" fill="rgba(230,200,240,0.4)" stroke="rgba(180,140,100,0.6)" stroke-width="2"/>
                    <text x="812" y="255" text-anchor="middle" font-size="13" font-weight="600" font-family="'Fredoka', sans-serif" fill="#6B4423">Guest Bedroom</text>

                    <!-- GROUND FLOOR ROOMS (y: 355-600) -->
                    <!-- Hall -->
                    <rect x="105" y="355" width="195" height="245" fill="rgba(200,230,228,0.4)" stroke="rgba(180,140,100,0.6)" stroke-width="2"/>
                    <text x="202" y="380" text-anchor="middle" font-size="14" font-weight="600" font-family="'Fredoka', sans-serif" fill="#6B4423">Hall</text>

                    <!-- Lounge -->
                    <rect x="300" y="355" width="195" height="245" fill="rgba(255,220,180,0.4)" stroke="rgba(180,140,100,0.6)" stroke-width="2"/>
                    <text x="397" y="380" text-anchor="middle" font-size="14" font-weight="600" font-family="'Fredoka', sans-serif" fill="#6B4423">Lounge</text>

                    <!-- Nest Thermostat on Lounge Wall -->
                    <g id="nest-thermostat-display" transform="translate(397, 500)">
                        <circle cx="0" cy="0" r="26" fill="url(#nestMetalGradient)" stroke="#B8B8B8" stroke-width="1.5"/>
                        <circle id="nest-display-bg" cx="0" cy="0" r="22" fill="#000000"/>
                        <text id="nest-current-temp" x="0" y="4" text-anchor="middle" font-size="15" font-weight="700" font-family="Arial, sans-serif" fill="#FFFFFF">--</text>
                        <text id="nest-target-temp" x="0" y="-10" text-anchor="middle" font-size="6" font-family="Arial, sans-serif" fill="#888888">--</text>
                        <text id="nest-status-text" x="0" y="14" text-anchor="middle" font-size="5" font-family="Arial, sans-serif" fill="#666666">OFF</text>
                        <circle id="nest-status-ring" cx="0" cy="0" r="24" fill="none" stroke="transparent" stroke-width="1.5" opacity="0.6"/>
                    </g>

                    <!-- Kitchen -->
                    <rect x="495" y="355" width="195" height="245" fill="rgba(255,230,200,0.4)" stroke="rgba(180,140,100,0.6)" stroke-width="2"/>
                    <text x="592" y="380" text-anchor="middle" font-size="14" font-weight="600" font-family="'Fredoka', sans-serif" fill="#6B4423">Kitchen</text>

                    <!-- Extension -->
                    <rect x="690" y="355" width="210" height="245" fill="rgba(200,230,220,0.4)" stroke="rgba(180,140,100,0.6)" stroke-width="2"/>
                    <text x="795" y="380" text-anchor="middle" font-size="14" font-weight="600" font-family="'Fredoka', sans-serif" fill="#6B4423">Extension</text>
                </g>

                <!-- Thermometers will be dynamically added here by JavaScript -->
                <g id="thermometers-container"></g>

                <!-- Light indicators will be dynamically added here by JavaScript -->
                <g id="light-indicators-container"></g>

                <!-- Sonos Controls (dynamically generated) -->
                <g id="sonos-controls-container"></g>

                <!-- SHIELD TV Controls (dynamically generated) -->
                <g id="shield-controls-container"></g>

                <!-- Light Effects Jukebox - Extension Room (Pixel Art Style) -->
                <g id="jukebox" transform="translate(795, 520)">
                    <defs>
                        <linearGradient id="jukeboxGradient" x1="0%" y1="0%" x2="0%" y2="100%">
                            <stop offset="0%" style="stop-color:#C9A227" />
                            <stop offset="50%" style="stop-color:#8B7355" />
                            <stop offset="100%" style="stop-color:#5A4A3A" />
                        </linearGradient>
                        <linearGradient id="screenGlow" x1="0%" y1="0%" x2="0%" y2="100%">
                            <stop offset="0%" style="stop-color:#2D5A5A" />
                            <stop offset="100%" style="stop-color:#1E4040" />
                        </linearGradient>
                    </defs>

                    <!-- Pixel jukebox body -->
                    <rect x="-40" y="-55" width="80" height="95" fill="url(#jukeboxGradient)" stroke="#3A2A1A" stroke-width="2"/>
                    <rect x="-38" y="-53" width="76" height="4" fill="#D4B84A"/>
                    <rect x="-38" y="34" width="76" height="4" fill="#D4B84A"/>

                    <!-- Screen -->
                    <rect x="-32" y="-45" width="64" height="28" fill="url(#screenGlow)" stroke="#1A2A2A" stroke-width="2"/>
                    <text x="0" y="-28" text-anchor="middle" fill="#C9A227" font-size="7" font-weight="bold" font-family="'Fredoka', sans-serif">LIGHT EFFECTS</text>
                    <text x="0" y="-18" text-anchor="middle" fill="#7FB5A0" font-size="5" font-family="'Fredoka', sans-serif">Select Effect</text>

                    <!-- Pixel effect buttons -->
                    <g id="jukebox-btn-1" class="jukebox-button" transform="translate(-22, 0)" style="cursor: pointer;">
                        <rect x="-8" y="-8" width="16" height="16" fill="#E84855" stroke="#8B0000" stroke-width="1"/>
                        <text x="0" y="4" text-anchor="middle" fill="#FFF" font-size="9">üö®</text>
                    </g>

                    <g id="jukebox-btn-2" class="jukebox-button" transform="translate(0, 0)" style="cursor: pointer;">
                        <rect x="-8" y="-8" width="16" height="16" fill="#9B59B6" stroke="#6B3A86" stroke-width="1"/>
                        <text x="0" y="4" text-anchor="middle" fill="#FFF" font-size="9">üéâ</text>
                    </g>

                    <g id="jukebox-btn-3" class="jukebox-button" transform="translate(22, 0)" style="cursor: pointer;">
                        <rect x="-8" y="-8" width="16" height="16" fill="#F39C12" stroke="#B87A0A" stroke-width="1"/>
                        <text x="0" y="4" text-anchor="middle" fill="#FFF" font-size="9">üï∫</text>
                    </g>

                    <g id="jukebox-btn-4" class="jukebox-button" transform="translate(-11, 22)" style="cursor: pointer;">
                        <rect x="-8" y="-8" width="16" height="16" fill="#3498DB" stroke="#2070A0" stroke-width="1"/>
                        <text x="0" y="4" text-anchor="middle" fill="#FFF" font-size="9">üåä</text>
                    </g>

                    <g id="jukebox-btn-5" class="jukebox-button" transform="translate(11, 22)" style="cursor: pointer;">
                        <rect x="-8" y="-8" width="16" height="16" fill="#E67E22" stroke="#A05A10" stroke-width="1"/>
                        <text x="0" y="4" text-anchor="middle" fill="#FFF" font-size="9">üåÖ</text>
                    </g>

                    <!-- Pixel indicator lights -->
                    <rect x="-35" y="-52" width="4" height="4" fill="#E84855">
                        <animate attributeName="opacity" values="1;0.3;1" dur="1s" repeatCount="indefinite"/>
                    </rect>
                    <rect x="31" y="-52" width="4" height="4" fill="#2ECC71">
                        <animate attributeName="opacity" values="0.3;1;0.3" dur="1s" repeatCount="indefinite"/>
                    </rect>
                </g>

                <!-- Tapo Smart Plug Controls (dynamically generated) -->
                <g id="tapo-plugs-container"></g>

                <!-- Motion indicators will be dynamically added here by JavaScript -->
                <g id="motion-indicators-container"></g>

                <!-- ============================================
                     OUTDOOR AREA - GARDEN DETAILS
                     ============================================ -->
                <g id="outdoor-area" transform="translate(20, 380)">

                    <!-- Pixel Art Tree -->
                    <g id="garden-tree" transform="translate(30, 120)">
                        <!-- Trunk -->
                        <rect x="15" y="60" width="20" height="80" fill="#6B4423"/>
                        <rect x="17" y="60" width="4" height="80" fill="#8B5A33"/>
                        <rect x="31" y="70" width="4" height="60" fill="#5A3413"/>
                        <!-- Tree crown (layered circles for pixel feel) -->
                        <circle cx="25" cy="40" r="40" fill="#3D8B3D"/>
                        <circle cx="10" cy="30" r="32" fill="#4A9A4A"/>
                        <circle cx="40" cy="30" r="32" fill="#4A9A4A"/>
                        <circle cx="25" cy="15" r="28" fill="#5AAA5A"/>
                        <circle cx="5" cy="45" r="20" fill="#3D8B3D"/>
                        <circle cx="45" cy="45" r="20" fill="#3D8B3D"/>
                        <!-- Highlight spots -->
                        <circle cx="15" cy="25" r="8" fill="#6ABA6A" opacity="0.6"/>
                        <circle cx="35" cy="20" r="6" fill="#6ABA6A" opacity="0.5"/>
                    </g>

                    <!-- Victorian Lamppost (Narnia-style) - Larger, Draggable -->
                    <g id="outdoor-lamppost" class="draggable-element" transform="translate(70, -20)" style="cursor: move;">
                        <!-- Ornate stepped base -->
                        <rect x="0" y="220" width="40" height="10" fill="#2C3E50" rx="2"/>
                        <rect x="4" y="212" width="32" height="10" fill="#34495E" rx="1"/>
                        <rect x="8" y="206" width="24" height="8" fill="#2C3E50" rx="1"/>

                        <!-- Main post -->
                        <rect x="14" y="70" width="12" height="140" fill="#34495E"/>
                        <rect x="16" y="70" width="4" height="140" fill="#4A5A6A"/>
                        <rect x="22" y="70" width="2" height="140" fill="#2C3E50"/>

                        <!-- Decorative rings on post -->
                        <rect x="12" y="85" width="16" height="4" fill="#2C3E50" rx="1"/>
                        <rect x="12" y="120" width="16" height="4" fill="#2C3E50" rx="1"/>
                        <rect x="12" y="155" width="16" height="4" fill="#2C3E50" rx="1"/>
                        <rect x="12" y="190" width="16" height="4" fill="#2C3E50" rx="1"/>

                        <!-- Ornate collar below lamp -->
                        <rect x="10" y="62" width="20" height="10" fill="#2C3E50"/>
                        <rect x="8" y="58" width="24" height="6" fill="#3D5A6A"/>

                        <!-- Decorative scrollwork brackets -->
                        <path d="M20,70 Q5,80 8,95" fill="none" stroke="#2C3E50" stroke-width="3" stroke-linecap="round"/>
                        <path d="M20,70 Q35,80 32,95" fill="none" stroke="#2C3E50" stroke-width="3" stroke-linecap="round"/>

                        <!-- Lamp housing (larger, more ornate) -->
                        <g id="lamp-housing">
                            <!-- Lamp roof/cap -->
                            <polygon points="20,20 40,55 0,55" fill="#5A4A3A"/>
                            <polygon points="20,24 36,52 4,52" fill="#6B5A4A"/>
                            <!-- Finial on top -->
                            <circle cx="20" cy="18" r="4" fill="#C9A227"/>
                            <rect x="18" y="14" width="4" height="6" fill="#8B7355"/>

                            <!-- Glass panels -->
                            <rect x="4" y="55" width="32" height="24" fill="#1E3A3A" opacity="0.4"/>
                            <rect x="4" y="55" width="32" height="24" fill="none" stroke="#2C3E50" stroke-width="2"/>

                            <!-- Glass panel dividers -->
                            <line x1="14" y1="55" x2="14" y2="79" stroke="#2C3E50" stroke-width="2"/>
                            <line x1="26" y1="55" x2="26" y2="79" stroke="#2C3E50" stroke-width="2"/>
                            <line x1="4" y1="67" x2="36" y2="67" stroke="#2C3E50" stroke-width="1.5"/>

                            <!-- The lamp bulb inside -->
                            <circle cx="20" cy="67" r="8" fill="#666" id="lamp-bulb"/>

                            <!-- Lamp base trim -->
                            <rect x="2" y="77" width="36" height="4" fill="#2C3E50"/>
                        </g>

                        <!-- Lamp glow (visible when on) -->
                        <circle cx="20" cy="67" r="20" fill="#FFD700" opacity="0" id="lamp-glow">
                            <animate attributeName="opacity" values="0;0" dur="1s" repeatCount="indefinite"/>
                        </circle>
                    </g>

                    <!-- Milk Bottles (classic UK touch!) -->
                    <g id="milk-bottles" transform="translate(140, 200)">
                        <rect x="0" y="2" width="8" height="14" fill="#F5F5F5" stroke="#DDD" stroke-width="1" rx="1"/>
                        <rect x="1" y="0" width="6" height="3" fill="#E0E0E0"/>
                        <rect x="2" y="5" width="4" height="8" fill="#FAFAFA"/>
                        <rect x="12" y="2" width="8" height="14" fill="#F5F5F5" stroke="#DDD" stroke-width="1" rx="1"/>
                        <rect x="13" y="0" width="6" height="3" fill="#E0E0E0"/>
                        <rect x="14" y="5" width="4" height="8" fill="#FAFAFA"/>
                    </g>

                    <!-- Garden Cat (sitting on wall) -->
                    <g id="garden-cat" transform="translate(75, 175)">
                        <!-- Body -->
                        <ellipse cx="0" cy="8" rx="10" ry="8" fill="#4A4A4A"/>
                        <!-- Head -->
                        <circle cx="-5" cy="-2" r="7" fill="#4A4A4A"/>
                        <!-- Ears -->
                        <polygon points="-10,-8 -8,-2 -12,-2" fill="#4A4A4A"/>
                        <polygon points="0,-8 2,-2 -2,-2" fill="#4A4A4A"/>
                        <polygon points="-9,-6 -8,-3 -11,-3" fill="#FF9999"/>
                        <polygon points="-1,-6 0,-3 -2,-3" fill="#FF9999"/>
                        <!-- Eyes -->
                        <circle cx="-7" cy="-3" r="2" fill="#90EE90"/>
                        <circle cx="-3" cy="-3" r="2" fill="#90EE90"/>
                        <circle cx="-7" cy="-3" r="1" fill="#1A1A1A"/>
                        <circle cx="-3" cy="-3" r="1" fill="#1A1A1A"/>
                        <!-- Tail -->
                        <path d="M10,5 Q18,0 15,-8" fill="none" stroke="#4A4A4A" stroke-width="4" stroke-linecap="round"/>
                    </g>

                    <!-- Outdoor thermometer container -->
                    <g id="outdoor-thermometer-container"></g>
                </g>

                <!-- ============================================
                     GARDEN FLOWERS & PLANTS
                     ============================================ -->
                <!-- Front garden flowers (left) -->
                <g id="garden-flowers-left" transform="translate(140, 630)">
                    <!-- Tulips -->
                    <rect x="0" y="5" width="2" height="20" fill="#228B22"/>
                    <ellipse cx="1" cy="2" rx="5" ry="8" fill="#FF4757"/>
                    <rect x="15" y="8" width="2" height="17" fill="#228B22"/>
                    <ellipse cx="16" cy="5" rx="4" ry="7" fill="#FF6B81"/>
                    <rect x="30" y="3" width="2" height="22" fill="#228B22"/>
                    <ellipse cx="31" cy="0" rx="5" ry="8" fill="#FF4757"/>
                    <!-- Daffodils -->
                    <rect x="50" y="6" width="2" height="19" fill="#228B22"/>
                    <circle cx="51" cy="3" r="6" fill="#FFD700"/>
                    <circle cx="51" cy="3" r="3" fill="#FFA500"/>
                    <rect x="65" y="4" width="2" height="21" fill="#228B22"/>
                    <circle cx="66" cy="1" r="5" fill="#FFD700"/>
                    <circle cx="66" cy="1" r="2.5" fill="#FFA500"/>
                </g>

                <!-- Front garden flowers (right) -->
                <g id="garden-flowers-right" transform="translate(820, 635)">
                    <!-- Lavender -->
                    <rect x="0" y="5" width="2" height="18" fill="#228B22"/>
                    <ellipse cx="1" cy="0" rx="3" ry="6" fill="#9370DB"/>
                    <rect x="12" y="3" width="2" height="20" fill="#228B22"/>
                    <ellipse cx="13" cy="-2" rx="3" ry="6" fill="#8A2BE2"/>
                    <rect x="24" y="6" width="2" height="17" fill="#228B22"/>
                    <ellipse cx="25" cy="1" rx="3" ry="6" fill="#9370DB"/>
                    <!-- Roses -->
                    <rect x="40" y="4" width="2" height="19" fill="#228B22"/>
                    <circle cx="41" cy="1" r="6" fill="#E84855"/>
                    <circle cx="39" cy="-1" r="3" fill="#FF6B6B"/>
                    <rect x="55" y="2" width="2" height="21" fill="#228B22"/>
                    <circle cx="56" cy="-1" r="5" fill="#FF4D6D"/>
                    <circle cx="54" cy="-3" r="2.5" fill="#FF8FA3"/>
                </g>

                <!-- Garden hedge/border -->
                <g id="garden-hedge">
                    <rect x="95" y="598" width="15" height="8" fill="#3D6A2A" rx="2"/>
                    <rect x="895" y="598" width="15" height="8" fill="#3D6A2A" rx="2"/>
                </g>

                <!-- Moose character container (dynamically populated) -->
                <g id="moose-container"></g>

                <!-- Color picker popup container (on top of everything) -->
                <g id="color-picker-container"></g>
            </svg>
        </div>

        <div class="stats-grid">
            <!-- Weather now displayed in sky SVG -->
        </div>

        <!-- Sensor Details Panel -->
        <div class="graph-container" style="margin-top: 20px;">
            <h2 class="graph-title section-header" onclick="toggleSection('sensor-details-content', 'sensor-arrow')">
                <span class="section-arrow collapsed" id="sensor-arrow">‚ñº</span>
                üì° Sensor Details
            </h2>
            <div id="sensor-details-content" class="collapsible-content collapsed">
                <div id="sensor-details" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 15px; padding: 15px;">
                    <div style="text-align: center; color: #999; padding: 20px;">Loading sensor data...</div>
                </div>
            </div>
        </div>

        <!-- Activity Log -->
        <div class="graph-container" style="margin-top: 20px;">
            <h2 class="graph-title section-header" onclick="toggleSection('motion-log-content', 'motion-arrow')">
                <span class="section-arrow collapsed" id="motion-arrow">‚ñº</span>
                üìã 48-Hour Activity Log
            </h2>
            <div id="motion-log-content" class="collapsible-content collapsed">
                <div id="motion-log" style="max-height: 300px; overflow-y: auto; padding: 15px; background: #f9f9f9; border-radius: 10px; font-family: 'Courier New', monospace; font-size: 13px;">
                    <div style="text-align: center; color: #999; padding: 20px;">Loading activity history...</div>
                </div>
                <div style="text-align: center; margin-top: 10px; font-size: 12px; color: #666;">
                    <span id="motion-log-count">0</span> events in last 48 hours
                </div>
            </div>
        </div>

    </div>

    <!-- Global Configuration (must load before modules) -->
    <script src="config.js"></script>
    <script src="nest-config.js"></script>

    <!-- Shared utilities needed by non-module scripts -->
    <script src="js/config.js"></script>
    <script src="js/config/schema.js"></script>
    <script src="js/config/loader.js"></script>
    <script src="js/config/index.js"></script>
    <script src="js/config/mappings.js"></script>
    <script src="js/utils/logger.js"></script>
    <script src="js/utils/helpers.js"></script>
    <script src="js/ui/draggable.js"></script>
    <script src="js/ui/color-picker.js"></script>
    <script src="js/ui/layers.js"></script>

    <!-- Core Modules (infrastructure for app.js) -->
    <script src="js/core/events.js"></script>
    <script src="js/core/state.js"></script>
    <script src="js/core/connection-monitor.js"></script>
    <script src="js/core/poller.js"></script>
    <script src="js/core/initializer.js"></script>

    <!-- API Clients -->
    <script src="js/api/hue.js"></script>
    <script src="js/api/sonos.js"></script>
    <script src="js/api/tapo.js"></script>
    <script src="js/api/shield.js"></script>

    <!-- Feature Modules -->
    <script src="js/features/tapo.js"></script>
    <script src="js/features/nest.js"></script>
    <script src="js/features/sonos.js"></script>
    <script src="js/features/shield.js"></script>
    <script src="js/features/effects.js"></script>
    <script src="js/features/moose.js"></script>
    <script src="js/features/news-plane.js"></script>
    <script src="js/features/motion-indicators.js"></script>

    <!-- Main Application - NEW MODULAR VERSION -->
    <script src="js/app.js"></script>

    <!--
    ==========================================================================
    LEGACY main.js (kept for reference, can be deleted once app.js is verified)
    To revert: comment out app.js above, uncomment main.js below
    <script src="js/main.js"></script>
    ==========================================================================
    -->

    <!-- Service Worker Registration -->
    <script>
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('/service-worker.js')
                    .then((registration) => {
                        console.log('Service Worker registered:', registration.scope);
                    })
                    .catch((error) => {
                        console.log('Service Worker registration failed:', error);
                    });
            });
        }
    </script>
</body>
</html>
